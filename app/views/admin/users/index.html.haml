=# render :template=>'layouts/admin_sub_nav'

%h1.mb-3.text-warning Admin: User Accounts

.row
  &nbsp;
  TODO: add resend-confirmation.  disable active user, toggle admin bit.
.row
  .col-sm-12
    %table.table
      %thead
        %th id / uid
        %th provider
        %th avatar
        %th name
        %th email
        %th tenant_id
        %th sign in count
        %th last logged in
        %th created at
        %th confirmed at
        %th admin? approved? active?
      %tfoot
        %tr
          %td{:colspan=>15}= will_paginate @users
      %tbody
        - @users.each do |user|
          %tr
            - ( [["id", "uid"], "provider" ] + [ Proc.new {|u| render_avatar(user) } ] + [ Proc.new { |u| u.provider == 'github' ? link_to(u.name, "https://github.com/#{u.name}", target: "_blank") : u.name }, Proc.new{ |u| mail_to(u.email) }] + %w[tenant_id sign_in_count last_sign_in_at created_at confirmed_at] + [ Proc.new {|u| %w[admin? approved active].map {|f| "#{u.send(f) ? f_icon("check", :color => 'green') : f_icon("x", :color=>'red') } #{f}" }.join("<br/>").html_safe } ] ).each do |field|
              %td
                - if field.respond_to?(:call)
                  = field.call(user)
                - else
                  = Array(field).map { |f| user.send(f) }.join("\n")
